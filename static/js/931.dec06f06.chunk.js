"use strict";(self.webpackChunkroman_flights=self.webpackChunkroman_flights||[]).push([[931],{3931:(e,t,r)=>{r.r(t),r.d(t,{default:()=>re});var n=r(5043),s=r(6446),o=r(5865),i=r(579);const a=function(){return(0,i.jsx)(s.A,{sx:{backgroundImage:"url(https://www.gstatic.com/travel-frontend/animation/hero/flights_nc_4.svg)",width:"100%",aspectRatio:4.2,backgroundRepeat:"no-repeat",backgroundPosition:"center",position:"relative"},children:(0,i.jsx)(o.A,{variant:"h1",component:"h1",align:"center",sx:{position:"absolute",width:"100%",bottom:0},children:"Roman Flights"})})};var l=r(9252),c=r(8911),d=r(6213),u=r(2907);const h="71616017f8msh278dc76385f39d0p1fa0b2jsn99b054693411",p="sky-scrapper.p.rapidapi.com",x=async e=>{try{return(await d.A.request(e)).data}catch(t){throw console.error("API Error:",t.response||t.message),t}};var m=r(1036),g=r(5761),f=r(1059),v=r(6060);const A=(0,v.A)(g.A)((e=>{let{theme:{palette:t}}=e;return{backgroundColor:"#fff",border:`1px solid ${t.border.main}`,borderRadius:"7.5px","&:before":{content:"unset"},"&:after":{content:"unset"},px:1,minHeight:"48px",paddingInline:"10px 0",paddingBlock:"10px ",width:"100%","&:hover":{borderColor:t.blue.main}}}));(0,v.A)(f.A)((e=>{let{theme:{palette:t}}=e;return{backgroundColor:"#fff",border:"1px solid",borderColor:t.border.main,borderRadius:"7.5px",fontSize:"16px",fontWeight:400,lineHeight:"21.79px",textAlign:"start",color:"#434343","& .MuiSelect-select":{paddingBlock:"7px"}}}));var j=r(3106),b=r(6758),w=r(1787),y=r(1413);const k=function(e){let{res:t,setSelectedLocation:r}=e;return(0,i.jsx)(i.Fragment,{children:"AIRPORT"===t.navigation.entityType&&(0,i.jsxs)(c.A,{spacing:1,p:1,direction:"row",alignItems:"center",onClick:()=>r(t),sx:{cursor:"pointer"},children:[(0,i.jsx)(y.A,{}),(0,i.jsxs)(c.A,{alignItems:"start",children:[(0,i.jsx)(o.A,{children:t.presentation.suggestionTitle}),(0,i.jsx)(o.A,{children:t.presentation.subtitle})]})]})})};var S=r(1637),C=r(1906);const E=(0,v.A)(c.A)((e=>{let{theme:{palette:t}}=e;return{position:"absolute",zIndex:2,top:"110%",left:"0",background:"white",width:"100%",border:"1px solid #D9D9D9",borderRadius:"7.5px",maxHeight:"350px",overflow:"auto"}})),P=(0,v.A)(c.A)((e=>{let{theme:{palette:t}}=e;return{position:"relative",width:"100%",borderRadius:"10px",boxShadow:"0 1px 3px 0 rgba(60, 64, 67, .3), 0 4px 8px 3px rgba(60, 64, 67, .15)"}})),I=(0,v.A)(c.A)((e=>{let{theme:{palette:t}}=e;return{width:"100%",border:`1px solid ${t.border.main}`,borderRadius:"5px"}})),F=(0,v.A)(c.A)((e=>{let{theme:{palette:t}}=e;return{flexGrow:1,".rs-picker":{width:"100%"},".rs-picker-input-group":{height:"100%"},".rs-icon":{height:"25px",width:"25px"}}})),R=(0,v.A)(S.A)((e=>{let{theme:{palette:t}}=e;return{position:"absolute",zIndex:2,top:"10%",right:"5%"}})),T=(0,v.A)(C.A)((e=>{let{theme:{palette:t}}=e;return{position:"absolute",bottom:0,left:"50%",transform:"translate(-50%,50%)"}})),L=(0,n.createContext)(void 0),D=e=>{let{children:t}=e;const[r,s]=(0,n.useState)({from:void 0,to:void 0,dates:{start:null,end:null},filters:{adults:1,class:"economy"}}),[o,a]=(0,n.useState)(void 0),l={...(0,n.useMemo)((()=>({searchParams:r,setSearchParams:s})),[r]),flightResults:o,setFlightResults:a};return(0,i.jsx)(L.Provider,{value:l,children:t})},M=()=>{const e=(0,n.useContext)(L);if(!e)throw new Error("useSearchContext must be used within a SearchContextProvider");return e};const Y=function(e){var t;let{direction:r}=e;const{searchParams:o,setSearchParams:a}=M(),{handleSearchAirport:l,isLoading:c,isError:d,data:m,error:g}=(()=>{const{mutateAsync:e,isLoading:t,isError:r,data:n,error:s}=(0,u.useMutation)({mutationFn:async e=>x({method:"GET",url:"https://sky-scrapper.p.rapidapi.com/api/v1/flights/searchAirport",params:{query:e,locale:"en-US"},headers:{"x-rapidapi-key":h,"x-rapidapi-host":p}}),onSuccess:e=>{console.log("Airport search successful:",e)},onError:e=>{console.error("Error during airport search:",e)}});return{handleSearchAirport:e,isLoading:t,isError:r,data:n,error:s}})(),[f,v]=(0,n.useState)(""),[y,S]=(0,n.useState)(void 0),[C,P]=(0,n.useState)(!1),I=(0,n.useRef)(null),F=((e,t)=>{let r;return function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];clearTimeout(r),r=setTimeout((()=>e(...s)),t)}})((e=>{const t=l(e);console.log("\ud83d\ude80 ~ handleSearchChange ~ res:",t)}),300);return(0,n.useEffect)((()=>{P(!1),v(null===y||void 0===y?void 0:y.presentation.suggestionTitle),a("to"===r?{...o,to:y}:{...o,from:y})}),[y]),(0,n.useEffect)((()=>{const e=e=>{I.current&&!I.current.contains(e.target)&&(P(!1),v(null===y||void 0===y?void 0:y.presentation.suggestionTitle))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,i.jsxs)(s.A,{ref:I,sx:{position:"relative",flexGrow:1},children:[(0,i.jsx)(A,{startAdornment:(0,i.jsx)(w.A,{position:"start",children:"from"===r?(0,i.jsx)(j.A,{}):(0,i.jsx)(b.A,{})}),placeholder:"from"===r?"Where from?":"Where to?",onChange:e=>{v(e.target.value),F(e.target.value),P(!0)},value:f}),c&&(0,i.jsx)(R,{}),C&&(null===m||void 0===m?void 0:m.data)&&(null===m||void 0===m||null===(t=m.data)||void 0===t?void 0:t.length)>0&&(0,i.jsx)(E,{spacing:1,children:m.data.map(((e,t)=>(0,i.jsx)(k,{res:e,setSelectedLocation:S},t)))})]})};var H=r(671),W=r(6178),B=r.n(W);r(6791);const G=function(){const{searchParams:e,setSearchParams:t}=M();return(0,i.jsx)(F,{direction:"row",children:(0,i.jsx)(H.A,{format:"MMM dd, yyyy",placeholder:"Select Dates",showOneCalendar:window.innerWidth<1410,onChange:r=>function(r){if(r){const n=B()(r[0]).format("YYYY-MM-DD"),s=B()(r[1]).format("YYYY-MM-DD");t({...e,dates:{start:n,end:s}})}}(r)})})};var z=r(9578),_=r(5101),U=r(6990),q=r(4318),N=r(2224);const O=function(){const{searchParams:e,setSearchParams:t}=M(),[r,s]=(0,n.useState)(null),[a,l]=(0,n.useState)(!1),d=r=>{let n={...e};r?n.filters.adults++:n.filters.adults--,t(n)};return(0,i.jsxs)(C.A,{onClick:e=>{s(e.currentTarget),l(!0)},children:[(0,i.jsx)(q.A,{}),(0,i.jsx)(o.A,{children:e.filters.adults}),(0,i.jsx)(N.A,{}),(0,i.jsx)(_.A,{id:"basic-menu",anchorEl:r,open:a,onClose:e=>(e=>{e.stopPropagation(),l(!1),s(null)})(e),MenuListProps:{"aria-labelledby":"basic-button"},children:(0,i.jsx)(U.A,{sx:{"&:hover":{backgroundColor:"transparent"}},children:(0,i.jsxs)(c.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,i.jsx)(o.A,{children:"Adults"}),(0,i.jsx)(C.A,{variant:1===e.filters.adults?"myDisabled":"containedLightBlue",onClick:()=>d(!1),children:"-"}),(0,i.jsx)(o.A,{children:e.filters.adults}),(0,i.jsx)(C.A,{variant:"containedLightBlue",onClick:()=>d(!0),children:"+"})]})})})]})};var $=r(5721),J=r(311),K=r(6353);const Q=["economy","premium_economy","business","first"];const V=function(){const{searchParams:e,setFlightResults:t}=M(),[r,s]=(0,n.useState)(null),[o,a]=(0,n.useState)(0),[l,c]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{let r={...e};r.filters.class=Q[o],t(r)}),[o]),(0,i.jsxs)(C.A,{onClick:e=>{s(e.currentTarget),c(!0)},children:[(0,i.jsx)($.A,{component:"nav","aria-label":"Device settings",sx:{bgcolor:"background.paper",padding:"0"},children:(0,i.jsx)(J.A,{id:"lock-button","aria-haspopup":"listbox","aria-controls":"lock-menu","aria-expanded":l?"true":void 0,onClick:e=>{s(e.currentTarget)},children:(0,i.jsx)(K.A,{primary:Q[o],sx:{textTransform:"capitalize"}})})}),(0,i.jsx)(_.A,{id:"lock-menu",anchorEl:r,open:l,onClose:e=>{e.stopPropagation(),c(!1),s(null)},MenuListProps:{"aria-labelledby":"lock-button",role:"listbox"},children:Q.map(((e,t)=>(0,i.jsx)(U.A,{selected:t===o,onClick:e=>((e,t)=>{e.stopPropagation(),a(t),s(null),c(!1)})(e,t),sx:{textTransform:"capitalize"},children:e},e)))})]})};const X=function(){return(0,i.jsxs)(c.A,{direction:"row",children:[(0,i.jsx)(O,{}),(0,i.jsx)(V,{})]})};const Z=function(){const{searchParams:e,setFlightResults:t}=M(),{handleSearchFlights:r,isLoading:s,data:o}=(()=>{const{mutateAsync:e,isLoading:t,isError:r,data:n,error:s}=(0,u.useMutation)({mutationFn:async e=>{var t,r,n,s;const o={method:"GET",url:"https://sky-scrapper.p.rapidapi.com/api/v2/flights/searchFlights",params:{originSkyId:null===(t=e.from)||void 0===t?void 0:t.skyId,destinationSkyId:null===(r=e.to)||void 0===r?void 0:r.skyId,originEntityId:null===(n=e.from)||void 0===n?void 0:n.entityId,destinationEntityId:null===(s=e.to)||void 0===s?void 0:s.entityId,cabinClass:e.filters.class||"economy",adults:e.filters.adults||1,date:e.dates.start,returnDate:e.dates.end,sortBy:"best",currency:"USD"},headers:{"x-rapidapi-key":h,"x-rapidapi-host":p}};return x(o)},onSuccess:e=>{console.log("Flights search successful:",e)},onError:e=>{console.error("Error during flight search:",e)}});return{handleSearchFlights:e,isLoading:t,isError:r,data:n,error:s}})();return(0,n.useEffect)((()=>{t({...o})}),[o]),(0,i.jsxs)(P,{p:2,pb:5,mt:"min(50px,5vw)",children:[(0,i.jsx)(X,{}),(0,i.jsxs)(c.A,{direction:"row",spacing:2,flexWrap:"wrap",useFlexGap:!0,children:[(0,i.jsx)(Y,{direction:"from"}),(0,i.jsx)(Y,{direction:"to"}),(0,i.jsx)(G,{})]}),s?(0,i.jsx)(S.A,{sx:{position:"absolute",bottom:0,left:"50%",translate:"-50% 150%"}}):(0,i.jsxs)(T,{variant:"containedBlue",onClick:()=>{const t=[{condition:!e.from,message:"Select Where From!"},{condition:!e.to,message:"Select Where To!"},{condition:!e.dates.start||!e.dates.end,message:"Select Dates!"}];for(const e of t)if(e.condition)return void(0,m.oR)(e.message);r(e)},children:[(0,i.jsx)(z.A,{}),"Search"]})]})};const ee=function(e){let{trip:t}=e;return(0,i.jsxs)(I,{direction:"row",alignItems:"center",justifyContent:"space-between",p:2,children:[(0,i.jsx)(c.A,{spacing:2,sx:{flexGrow:1},children:t.legs.length&&t.legs.map(((e,t)=>(0,i.jsxs)(c.A,{className:"leg",direction:"row",alignItems:"center",spacing:2,children:[(0,i.jsx)(s.A,{component:"img",src:e.carriers.marketing[0].logoUrl,sx:{width:"35px"}}),(0,i.jsx)(c.A,{children:(0,i.jsxs)(o.A,{children:[e.origin.city,"(",e.origin.displayCode,") -"," ",e.destination.city,"(",e.destination.displayCode,")"]})}),(0,i.jsx)(c.A,{children:(0,i.jsxs)(o.A,{children:[B()(e.departure).format("HH:mm")," ","- ",B()(e.arrival).format("HH:mm")]})})]},t)))}),(0,i.jsxs)(o.A,{children:["Price:",t.price.formatted]})]})};const te=function(){var e,t,r,n,a,l;const{flightResults:d}=M();return(0,i.jsxs)(s.A,{mt:3,sx:{width:"100%"},children:[("failure"===(null===d||void 0===d||null===(e=d.data)||void 0===e||null===(t=e.context)||void 0===t?void 0:t.status)||0===(null===d||void 0===d||null===(r=d.data)||void 0===r||null===(n=r.itineraries)||void 0===n?void 0:n.length))&&(0,i.jsx)(o.A,{children:"No Flights Found"}),(null===d||void 0===d||null===(a=d.data)||void 0===a||null===(l=a.itineraries)||void 0===l?void 0:l.length)>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.A,{mb:2,variant:"h4",children:"Flights Found:"}),(0,i.jsx)(c.A,{spacing:2,children:d.data.itineraries.map((e=>(0,i.jsx)(ee,{trip:e},e.id)))})]})]})};const re=function(){return(0,i.jsx)("div",{children:(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a,{}),(0,i.jsx)(D,{children:(0,i.jsxs)(c.A,{alignItems:"center",children:[(0,i.jsx)(Z,{}),(0,i.jsx)(te,{})]})})]})})}}}]);
//# sourceMappingURL=931.dec06f06.chunk.js.map